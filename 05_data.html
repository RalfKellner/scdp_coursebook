
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Working with Data &#8212; Scientific Computing and Digital Reporting with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '05_data';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Graphics" href="06_graphics.html" />
    <link rel="prev" title="Collecting data" href="04_getting_data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="00_welcome.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/course_logo.png" class="logo__image only-light" alt="Scientific Computing and Digital Reporting with Python - Home"/>
    <script>document.write(`<img src="_static/course_logo.png" class="logo__image only-dark" alt="Scientific Computing and Digital Reporting with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00_welcome.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_python_basics.html">How to use and install python</a></li>

<li class="toctree-l1"><a class="reference internal" href="02_sc_with_numpy.html">Scientific computing with numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_sc_with_scipy.html">Scientific computing with scipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_getting_data.html">Collecting data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_graphics.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_sklearn.html">SciKit Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_torch.html">Pytorch</a></li>

<li class="toctree-l1"><a class="reference internal" href="09_digital_reporting.html">Digital reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="A_math_statistics.html">Appendix - Math and statistics</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/05_data.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Working with Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframes-and-series">Pandas - DataFrames and Series</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing">Indexing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-methods">Useful Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plots">Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-and-exporting-data">Importing and Exporting Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#database-and-sql">Database and SQL</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#store-in-database">Store in Database</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="working-with-data">
<h1>Working with Data<a class="headerlink" href="#working-with-data" title="Link to this heading">#</a></h1>
<p>So far, you still may see python as a powerful calculator, however, it is so much more. One important tool is to import data, manipulate it, analyze and export it. Several libraries offer useful tools to work with data in order to allow for a meaningful analysis. One of the most popular and powerful is <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/index.html"><strong>Pandas</strong></a>. Beside including efficient ways for cleaning and manipulating data, pandas also includes functions for statistical analysis and graphics.</p>
<p>Usually, pandas is imported under the alias <code class="docutils literal notranslate"><span class="pre">pd</span></code>.</p>
<section id="pandas-dataframes-and-series">
<h2>Pandas - DataFrames and Series<a class="headerlink" href="#pandas-dataframes-and-series" title="Link to this heading">#</a></h2>
<section id="indexing">
<h3>Indexing<a class="headerlink" href="#indexing" title="Link to this heading">#</a></h3>
<p>The basic elements for data are <em>DataFrames</em> and <em>Series</em>. A DataFrame is a whole matrix- or table-like representation of data with column and row names. A Series can be understood as a single column of such a data matrix (but without the need for a table). There are respective functions to turn other objects, e.g. lists or dicts, into DataFrames or Series. Indexing, similar to lists or dicts, uses square brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">my_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="p">)</span>

<span class="n">my_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;series:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">my_series</span><span class="p">)</span>

<span class="c1"># selecting a single column from a DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;select column from df:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df:
    var1
0     1
1     2
2     3
3     4
4     5
5     6
6     7
series:
 0    1
1    2
2    3
3    4
4    5
5    6
6    7
dtype: int64
select column from df:
 0    1
1    2
2    3
3    4
4    5
5    6
6    7
Name: var1, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>To select specific rows or columns, the <code class="docutils literal notranslate"><span class="pre">iloc</span></code> method, for selecting based on an index, and <code class="docutils literal notranslate"><span class="pre">loc</span></code> method, based on labels, are recommended. Especially when several columns are to be selected. Indexing can also be done by boolean Series (or lists) and thus conditionally. Another way to select a single column is by chaining the column’s name to the DataFrame’s name by a dot (like in method chaining).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">56</span><span class="p">],</span>
 <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">183</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">172</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;person_a&#39;</span><span class="p">,</span> <span class="s1">&#39;person_b&#39;</span><span class="p">,</span> <span class="s1">&#39;person_c&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1.:&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;person_b&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="s1">&#39;is the same as&#39;</span><span class="p">,</span>  <span class="n">my_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># age &gt; 27</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;indexing by condition/list</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">my_df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span><span class="mi">27</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">corresponds to </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">my_df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span><span class="mi">27</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          age  height
person_a   20     183
person_b   34     179
person_c   56     172
1.: 34 is the same as 34
indexing by condition/list
           age  height
person_b   34     179
person_c   56     172 
corresponds to 
           age  height
person_b   34     179
person_c   56     172
&lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="useful-methods">
<h3>Useful Methods<a class="headerlink" href="#useful-methods" title="Link to this heading">#</a></h3>
<p>Pandas includes many useful methods that will help you get to know and manipulate a dataset. Some of these methods are shown in the following, others are introduced later when needed.<br />
More often than not, a dataset will contain missing values, i.e. cells in a data table contain no value. They will be depicted as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, <strong>N</strong>ot <strong>a</strong> <strong>N</strong>umber.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">my_df</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
 <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">183</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>  <span class="mi">163</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">my_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20.0</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>34.0</td>
      <td>179.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>163.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>44.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># view the first rows (view last rows with .tail())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;0.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># general information</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">1.&#39;</span><span class="p">)</span>
<span class="n">my_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="c1"># descriptive statistsics on dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">2.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">my_df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># number of missing values per column</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">3.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">my_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># single statistics are included as methods, also for single columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">4.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># fill missing values (e.g. with mean of column)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> 5.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">my_df</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>    

<span class="c1"># note that you must assign this to my_df (or a different variable) in order to impute missing values permanently!</span>
<span class="n">my_df</span> <span class="o">=</span> <span class="n">my_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">my_df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># sort values by column(s)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">6.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]))</span>    

<span class="c1"># get column names (useful for looping)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;7.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># drop rows containing missing values</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;8.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span> 

<span class="c1"># drop rows or columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;9.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># merge DataFrames (automatically on shared variable if not specified otherwise)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
 <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">83</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span>  <span class="mi">50</span><span class="p">,</span> <span class="mi">77</span><span class="p">]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;10.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">))</span>
<span class="n">my_df</span> <span class="o">=</span> <span class="n">my_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># correlation matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;11.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">corr</span><span class="p">())</span>

<span class="c1"># adding new columns</span>
<span class="n">my_df</span> <span class="o">=</span> <span class="n">my_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bmi</span> <span class="o">=</span> <span class="n">my_df</span><span class="o">.</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">my_df</span><span class="o">.</span><span class="n">height</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">my_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.
     age  height
0  20.0   183.0
1  34.0   179.0
2  56.0     NaN
3   NaN   163.0
4  44.0     NaN

1.
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5 entries, 0 to 4
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   age     4 non-null      float64
 1   height  3 non-null      float64
dtypes: float64(2)
memory usage: 212.0 bytes

2.
              age      height
count   4.000000    3.000000
mean   38.500000  175.000000
std    15.264338   10.583005
min    20.000000  163.000000
25%    30.500000  171.000000
50%    39.000000  179.000000
75%    47.000000  181.000000
max    56.000000  183.000000

3.
 age       1
height    2
dtype: int64

4.
 38.5

 5.
     age  height
0  20.0   183.0
1  34.0   179.0
2  56.0   175.0
3  38.5   163.0
4  44.0   175.0

6.
     age  height
3  38.5   163.0
2  56.0   175.0
4  44.0   175.0
1  34.0   179.0
0  20.0   183.0
7.
 Index([&#39;age&#39;, &#39;height&#39;], dtype=&#39;object&#39;)
8.
     age  height
0  20.0   183.0
1  34.0   179.0
2  56.0   175.0
3  38.5   163.0
4  44.0   175.0
9.
    height
0   183.0
1   179.0
2   175.0
3   163.0
4   175.0
10.
     age  height  weight
0  20.0   183.0      83
1  34.0   179.0      63
2  56.0   175.0      98
3  44.0   175.0      77
11.
              age    height    weight
age     1.000000 -0.946549  0.481176
height -0.946549  1.000000 -0.282126
weight  0.481176 -0.282126  1.000000
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>bmi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20.0</td>
      <td>183.0</td>
      <td>83</td>
      <td>24.784258</td>
    </tr>
    <tr>
      <th>1</th>
      <td>34.0</td>
      <td>179.0</td>
      <td>63</td>
      <td>19.662308</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56.0</td>
      <td>175.0</td>
      <td>98</td>
      <td>32.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>44.0</td>
      <td>175.0</td>
      <td>77</td>
      <td>25.142857</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As a last tool in this section, we will look at the <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code> function. Dummy variables are used to encode categorical variables with zero and one, for example in order to calculate the correlation with some other numerical variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="p">{</span><span class="s1">&#39;hair&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;blonde&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">hair</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   black  blonde    red
0  False    True  False
1   True   False  False
2  False   False   True
3  False   False   True
4   True   False  False
</pre></div>
</div>
</div>
</div>
</section>
<section id="plots">
<h3>Plots<a class="headerlink" href="#plots" title="Link to this heading">#</a></h3>
<p>Methods for standard pot types are available. For a histogram of the data, just use <code class="docutils literal notranslate"><span class="pre">.hist()</span></code>. Other types are available by chaining <code class="docutils literal notranslate"><span class="pre">.plot.</span></code> and the plot type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># histogram</span>
<span class="n">my_df</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># lineplot</span>
<span class="n">my_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># scatter plot</span>
<span class="n">my_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1a0fc635f5703ccadd3b9a474e645d222cfd6c6a552d030c059bffb700af683.png" src="_images/d1a0fc635f5703ccadd3b9a474e645d222cfd6c6a552d030c059bffb700af683.png" />
<img alt="_images/4eca9bf8846854671eead4f7fd5dd480e52fb342cd759ba56a190e03494a50c0.png" src="_images/4eca9bf8846854671eead4f7fd5dd480e52fb342cd759ba56a190e03494a50c0.png" />
<img alt="_images/4ab542dfdf55affdd377ebbaa5f5cc53276c4ed6c06281fbb5a0641bf5c2bdc4.png" src="_images/4ab542dfdf55affdd377ebbaa5f5cc53276c4ed6c06281fbb5a0641bf5c2bdc4.png" />
</div>
</div>
</section>
<section id="importing-and-exporting-data">
<h3>Importing and Exporting Data<a class="headerlink" href="#importing-and-exporting-data" title="Link to this heading">#</a></h3>
<p>Your data may come to you in various file formats. Pandas enables you to import data from all common formats. The respective functions are usually called <code class="docutils literal notranslate"><span class="pre">read_</span></code> and <code class="docutils literal notranslate"><span class="pre">to_</span></code> followed by the respective file type. To read a <em>.csv</em> for example, use the <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> function. Note that the file need not to be stored locally on your computer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">russell</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/close_prices_rua.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">russell</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">russell</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         Date         Open         High          Low        Close  \
0  2022-01-03  2788.020020  2804.939941  2783.040039  2804.929932   
1  2022-01-04  2788.020020  2817.110107  2783.040039  2800.409912   
2  2022-01-05  2799.729980  2801.260010  2738.939941  2739.340088   
3  2022-01-06  2739.229980  2756.689941  2721.560059  2739.199951   
4  2022-01-07  2739.060059  2748.270020  2718.560059  2725.600098   

     Adj Close  Volume  
0  2804.929932       0  
1  2800.409912       0  
2  2739.340088       0  
3  2739.199951       0  
4  2725.600098       0  
           Date         Open         High          Low        Close  \
533  2024-02-16  2885.469971  2890.629883  2870.000000  2882.639893   
534  2024-02-20  2859.389893  2862.790039  2842.050049  2853.409912   
535  2024-02-21  2845.770020  2855.149902  2834.800049  2854.620117   
536  2024-02-22  2877.489990  2915.370117  2876.699951  2911.399902   
537  2024-02-23  2919.000000  2923.610107  2908.379883  2913.219971   

       Adj Close  Volume  
533  2882.639893       0  
534  2853.409912       0  
535  2854.620117       0  
536  2911.399902       0  
537  2913.219971       0  
</pre></div>
</div>
</div>
</div>
<p>Lets do some exploration and manipulation of the historical data from the Russell 3000 index we just imported.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dimensionality of the data frame: </span><span class="si">{</span><span class="n">russell</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">russell</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>    <span class="c1"># the &#39;Date&#39; column is of dtype object </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensionality of the data frame: (538, 7)

&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 538 entries, 0 to 537
Data columns (total 7 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Date       538 non-null    object 
 1   Open       538 non-null    float64
 2   High       538 non-null    float64
 3   Low        538 non-null    float64
 4   Close      538 non-null    float64
 5   Adj Close  538 non-null    float64
 6   Volume     538 non-null    int64  
dtypes: float64(5), int64(1), object(1)
memory usage: 29.6+ KB
None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check type of first entry in &#39;Date&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">russell</span><span class="o">.</span><span class="n">Date</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;str&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The date is currently in string format, let us transform it to <em>datetime</em>, a special type for dates in python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">russell</span><span class="p">[</span><span class="s1">&#39;Datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">russell</span><span class="o">.</span><span class="n">Date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">russell</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>    <span class="c1"># check dtype now</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   2022-01-03
1   2022-01-04
2   2022-01-05
3   2022-01-06
4   2022-01-07
Name: Datetime, dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The column names are: </span><span class="se">\n</span><span class="si">{</span><span class="n">russell</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The column names are: 
Index([&#39;Date&#39;, &#39;Open&#39;, &#39;High&#39;, &#39;Low&#39;, &#39;Close&#39;, &#39;Adj Close&#39;, &#39;Volume&#39;,
       &#39;Datetime&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There are a total of </span><span class="si">{</span><span class="n">russell</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values in the data set&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are a total of 0 missing values in the data set
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">russell</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Datetime&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;Close&#39;</span><span class="p">])</span>    <span class="c1"># using Datetime for plotting</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/c6374e773acb930ff4de996963a5bcbd101482a51a7311b90b7488bc2e3c72e4.png" src="_images/c6374e773acb930ff4de996963a5bcbd101482a51a7311b90b7488bc2e3c72e4.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">describe</span></code> method offers some descriptive statistics of the data set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">russell</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
      <th>Datetime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>538.000000</td>
      <td>538.000000</td>
      <td>538.000000</td>
      <td>538.000000</td>
      <td>538.000000</td>
      <td>538.0</td>
      <td>538</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2445.081027</td>
      <td>2461.713682</td>
      <td>2427.139280</td>
      <td>2445.296892</td>
      <td>2445.296892</td>
      <td>0.0</td>
      <td>2023-01-27 15:07:21.635687680</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2035.680054</td>
      <td>2091.870117</td>
      <td>2026.229980</td>
      <td>2076.070068</td>
      <td>2076.070068</td>
      <td>0.0</td>
      <td>2022-01-03 00:00:00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2308.085022</td>
      <td>2322.982422</td>
      <td>2283.952393</td>
      <td>2304.890015</td>
      <td>2304.890015</td>
      <td>0.0</td>
      <td>2022-07-18 06:00:00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2417.375000</td>
      <td>2436.104980</td>
      <td>2398.869995</td>
      <td>2418.340088</td>
      <td>2418.340088</td>
      <td>0.0</td>
      <td>2023-01-28 12:00:00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2577.137451</td>
      <td>2594.047424</td>
      <td>2562.204956</td>
      <td>2577.842590</td>
      <td>2577.842590</td>
      <td>0.0</td>
      <td>2023-08-10 18:00:00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2919.000000</td>
      <td>2923.610107</td>
      <td>2908.379883</td>
      <td>2913.219971</td>
      <td>2913.219971</td>
      <td>0.0</td>
      <td>2024-02-23 00:00:00</td>
    </tr>
    <tr>
      <th>std</th>
      <td>181.644747</td>
      <td>179.224093</td>
      <td>184.264154</td>
      <td>182.332170</td>
      <td>182.332170</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For statistics on one variable, index the result as usual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_open</span> <span class="o">=</span> <span class="n">russell</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Open&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The average opening price is: </span><span class="si">{</span><span class="n">mean_open</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The average opening price is: 2445.08
</pre></div>
</div>
</div>
</div>
<p>Create a new column, with a flag if the closing price was higher than the opening price.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">russell</span> <span class="o">=</span> <span class="n">russell</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">positive</span> <span class="o">=</span> <span class="n">russell</span><span class="o">.</span><span class="n">Close</span> <span class="o">&gt;</span> <span class="n">russell</span><span class="o">.</span><span class="n">Open</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">russell</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># fraction of days when this was the case</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Fraction of positive days: </span><span class="si">{</span><span class="n">russell</span><span class="o">.</span><span class="n">positive</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">check: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">russell</span><span class="o">.</span><span class="n">positive</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         Date         Open         High          Low        Close  \
0  2022-01-03  2788.020020  2804.939941  2783.040039  2804.929932   
1  2022-01-04  2788.020020  2817.110107  2783.040039  2800.409912   
2  2022-01-05  2799.729980  2801.260010  2738.939941  2739.340088   
3  2022-01-06  2739.229980  2756.689941  2721.560059  2739.199951   
4  2022-01-07  2739.060059  2748.270020  2718.560059  2725.600098   

     Adj Close  Volume   Datetime  positive  
0  2804.929932       0 2022-01-03      True  
1  2800.409912       0 2022-01-04      True  
2  2739.340088       0 2022-01-05     False  
3  2739.199951       0 2022-01-06     False  
4  2725.600098       0 2022-01-07     False  

Fraction of positive days: 0.5037


check: 
 positive
True     271
False    267
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Extract same fraction for every day in the week. Days are counted from 0 (Monday) to 6 (Sunday).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;day </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">: &#39;</span><span class="p">,</span> <span class="n">russell</span><span class="p">[</span><span class="n">russell</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">positive</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>day 0:  0.5894736842105263
day 1:  0.4774774774774775
day 2:  0.4732142857142857
day 3:  0.4909090909090909
day 4:  0.5
day 5:  nan
day 6:  nan
</pre></div>
</div>
</div>
</div>
<p>A more straight forward way using built-in methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">russell</span> <span class="o">=</span> <span class="n">russell</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">wday</span> <span class="o">=</span> <span class="n">russell</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">)</span>
<span class="n">russell</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;wday&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># rows with nans are not calculated</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
      <th>positive</th>
    </tr>
    <tr>
      <th>wday</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2440.842010</td>
      <td>2455.321464</td>
      <td>2425.519058</td>
      <td>2442.503994</td>
      <td>2442.503994</td>
      <td>0.0</td>
      <td>0.589474</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2445.384592</td>
      <td>2461.678828</td>
      <td>2428.299915</td>
      <td>2445.511004</td>
      <td>2445.511004</td>
      <td>0.0</td>
      <td>0.477477</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2446.786429</td>
      <td>2464.452593</td>
      <td>2429.186787</td>
      <td>2445.830087</td>
      <td>2445.830087</td>
      <td>0.0</td>
      <td>0.473214</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2445.827283</td>
      <td>2463.293009</td>
      <td>2425.210918</td>
      <td>2445.252714</td>
      <td>2445.252714</td>
      <td>0.0</td>
      <td>0.490909</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2445.953007</td>
      <td>2462.901369</td>
      <td>2427.211006</td>
      <td>2446.994172</td>
      <td>2446.994172</td>
      <td>0.0</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="database-and-sql">
<h2>Database and SQL<a class="headerlink" href="#database-and-sql" title="Link to this heading">#</a></h2>
<p>Beside CSV (or Excel) files, another way to work with data is using databases. From there, data can be accessed using a query language. A very common one for relational databases is <strong>SQL</strong> (<strong>S</strong>tructured <strong>Q</strong>uery <strong>L</strong>anguage). It allows to extract specific records, i.e. records which meet special requirements, from a database using single commands. Structured databases usually include more than one table with data.</p>
<section id="store-in-database">
<h3>Store in Database<a class="headerlink" href="#store-in-database" title="Link to this heading">#</a></h3>
<p>First, saving a data frame to a database is conveniently done with a built-in method in Pandas. However, to access a database, a connection must first be established and we need to use SQL. In the following, we will use the <strong>sqlite3</strong> package for working with a database. An alternative is given by the <strong>sqlalchemy</strong> package.</p>
<p>Let us exampe all table names within the database:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;../data/nasdaq_nyse_amex_with_sec_info.sqlite&quot;</span><span class="p">)</span>
<span class="n">table_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           name
0  company_info
1     adj_close
2          high
3           low
4        volume
</pre></div>
</div>
</div>
</div>
<p>Now, let us examine a table, e.g., the <em>company_info</em>. To get a first impression, we can use the <code class="docutils literal notranslate"><span class="pre">pd.read_sql</span></code> method and grab the first five observations. This shows us the columns names and provides a first impression of the data. To do so, a query can be sent to get the required data from the database to a dataframe.
By convention, SQL is written in all CAPS, even though this is not required for the statement to work.</p>
<p>To select all columns from a table, the wildcard character <code class="docutils literal notranslate"><span class="pre">*</span></code> is used. The syntax is <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">&lt;col1&gt;,</span> <span class="pre">&lt;col2&gt;</span> <span class="pre">FROM</span> <span class="pre">&lt;table&gt;</span></code>. The <code class="docutils literal notranslate"><span class="pre">LIMIT</span> <span class="pre">5</span></code> limits data retrieval to the first five observations. Omit this if you want to grab all data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;../data/nasdaq_nyse_amex_with_sec_info.sqlite&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM company_info LIMIT 5;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
      <th>Market Cap</th>
      <th>IPO Year</th>
      <th>Volume</th>
      <th>Sector</th>
      <th>Industry</th>
      <th>cik</th>
      <th>ticker</th>
      <th>title</th>
      <th>as_of_date</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AACG</td>
      <td>ATA Creativity Global American Depositary Shares</td>
      <td>4.237371e+07</td>
      <td>2008.0</td>
      <td>6388</td>
      <td>Real Estate</td>
      <td>Other Consumer Services</td>
      <td>0001420529</td>
      <td>AACG</td>
      <td>ATA Creativity Global</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AADI</td>
      <td>Aadi Bioscience Inc. Common Stock</td>
      <td>4.586336e+07</td>
      <td>NaN</td>
      <td>147594</td>
      <td>Health Care</td>
      <td>Biotechnology: Pharmaceutical Preparations</td>
      <td>0001422142</td>
      <td>AADI</td>
      <td>Aadi Bioscience, Inc.</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AAGR</td>
      <td>African Agriculture Holdings Inc. Common Stock</td>
      <td>2.012500e+07</td>
      <td>2021.0</td>
      <td>56344</td>
      <td>Finance</td>
      <td>Finance: Consumer Services</td>
      <td>0001848898</td>
      <td>AAGR</td>
      <td>African Agriculture Holdings Inc.</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AAL</td>
      <td>American Airlines Group Inc. Common Stock</td>
      <td>9.665880e+09</td>
      <td>NaN</td>
      <td>23032392</td>
      <td>Consumer Discretionary</td>
      <td>Air Freight/Delivery Services</td>
      <td>0000006201</td>
      <td>AAL</td>
      <td>American Airlines Group Inc.</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AAME</td>
      <td>Atlantic American Corporation Common Stock</td>
      <td>5.263790e+07</td>
      <td>NaN</td>
      <td>1520</td>
      <td>Finance</td>
      <td>Life Insurance</td>
      <td>0000008177</td>
      <td>AAME</td>
      <td>ATLANTIC AMERICAN CORP</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We could also do this without the pandas method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;../data/nasdaq_nyse_amex_with_sec_info.sqlite&quot;</span><span class="p">)</span>
<span class="n">retrieval</span> <span class="o">=</span> <span class="n">out</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM company_info LIMIT 5;&quot;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">retrieval</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">out</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0,
  &#39;AACG&#39;,
  &#39;ATA Creativity Global American Depositary Shares&#39;,
  42373708.0,
  2008.0,
  6388,
  &#39;Real Estate&#39;,
  &#39;Other Consumer Services&#39;,
  &#39;0001420529&#39;,
  &#39;AACG&#39;,
  &#39;ATA Creativity Global&#39;,
  &#39;2024-02-22 19:35:15.357874&#39;),
 (2,
  &#39;AADI&#39;,
  &#39;Aadi Bioscience Inc. Common Stock&#39;,
  45863358.0,
  None,
  147594,
  &#39;Health Care&#39;,
  &#39;Biotechnology: Pharmaceutical Preparations&#39;,
  &#39;0001422142&#39;,
  &#39;AADI&#39;,
  &#39;Aadi Bioscience, Inc.&#39;,
  &#39;2024-02-22 19:35:15.357874&#39;),
 (3,
  &#39;AAGR&#39;,
  &#39;African Agriculture Holdings Inc. Common Stock&#39;,
  20125000.0,
  2021.0,
  56344,
  &#39;Finance&#39;,
  &#39;Finance: Consumer Services&#39;,
  &#39;0001848898&#39;,
  &#39;AAGR&#39;,
  &#39;African Agriculture Holdings Inc.&#39;,
  &#39;2024-02-22 19:35:15.357874&#39;),
 (4,
  &#39;AAL&#39;,
  &#39;American Airlines Group Inc. Common Stock&#39;,
  9665879525.0,
  None,
  23032392,
  &#39;Consumer Discretionary&#39;,
  &#39;Air Freight/Delivery Services&#39;,
  &#39;0000006201&#39;,
  &#39;AAL&#39;,
  &#39;American Airlines Group Inc.&#39;,
  &#39;2024-02-22 19:35:15.357874&#39;),
 (5,
  &#39;AAME&#39;,
  &#39;Atlantic American Corporation Common Stock&#39;,
  52637903.0,
  None,
  1520,
  &#39;Finance&#39;,
  &#39;Life Insurance&#39;,
  &#39;0000008177&#39;,
  &#39;AAME&#39;,
  &#39;ATLANTIC AMERICAN CORP&#39;,
  &#39;2024-02-22 19:35:15.357874&#39;)]
</pre></div>
</div>
</div>
</div>
<p>To select specific columns only, the can be listed, separated by a comma.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;../data/nasdaq_nyse_amex_with_sec_info.sqlite&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT Symbol, Name, Sector FROM company_info LIMIT 5;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
      <th>Sector</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AACG</td>
      <td>ATA Creativity Global American Depositary Shares</td>
      <td>Real Estate</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AADI</td>
      <td>Aadi Bioscience Inc. Common Stock</td>
      <td>Health Care</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AAGR</td>
      <td>African Agriculture Holdings Inc. Common Stock</td>
      <td>Finance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AAL</td>
      <td>American Airlines Group Inc. Common Stock</td>
      <td>Consumer Discretionary</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AAME</td>
      <td>Atlantic American Corporation Common Stock</td>
      <td>Finance</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The dataset can be filtered before being loaded into a dataframe. To pose restrictions on the import of records, use <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> after the table name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;../data/nasdaq_nyse_amex_with_sec_info.sqlite&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM company_info WHERE Volume &gt; 10000 LIMIT 5;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
      <th>Market Cap</th>
      <th>IPO Year</th>
      <th>Volume</th>
      <th>Sector</th>
      <th>Industry</th>
      <th>cik</th>
      <th>ticker</th>
      <th>title</th>
      <th>as_of_date</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>AADI</td>
      <td>Aadi Bioscience Inc. Common Stock</td>
      <td>4.586336e+07</td>
      <td>NaN</td>
      <td>147594</td>
      <td>Health Care</td>
      <td>Biotechnology: Pharmaceutical Preparations</td>
      <td>0001422142</td>
      <td>AADI</td>
      <td>Aadi Bioscience, Inc.</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AAGR</td>
      <td>African Agriculture Holdings Inc. Common Stock</td>
      <td>2.012500e+07</td>
      <td>2021.0</td>
      <td>56344</td>
      <td>Finance</td>
      <td>Finance: Consumer Services</td>
      <td>0001848898</td>
      <td>AAGR</td>
      <td>African Agriculture Holdings Inc.</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AAL</td>
      <td>American Airlines Group Inc. Common Stock</td>
      <td>9.665880e+09</td>
      <td>NaN</td>
      <td>23032392</td>
      <td>Consumer Discretionary</td>
      <td>Air Freight/Delivery Services</td>
      <td>0000006201</td>
      <td>AAL</td>
      <td>American Airlines Group Inc.</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AAOI</td>
      <td>Applied Optoelectronics Inc. Common Stock</td>
      <td>6.819469e+08</td>
      <td>2013.0</td>
      <td>2534547</td>
      <td>Technology</td>
      <td>Semiconductors</td>
      <td>0001158114</td>
      <td>AAOI</td>
      <td>APPLIED OPTOELECTRONICS, INC.</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AAON</td>
      <td>AAON Inc. Common Stock</td>
      <td>6.654766e+09</td>
      <td>NaN</td>
      <td>396290</td>
      <td>Industrials</td>
      <td>Industrial Machinery/Components</td>
      <td>0000824142</td>
      <td>AAON</td>
      <td>AAON, INC.</td>
      <td>2024-02-22 19:35:15.357874</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Only some of the other functions and commands will be shown, for a quick overview, see <a class="reference external" href="https://www.sqltutorial.org/sql-cheat-sheet/">this collection</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;../data/nasdaq_nyse_amex_with_sec_info.sqlite&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT AVG(Volume), Industry FROM company_info GROUP BY Industry;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AVG(Volume)</th>
      <th>Industry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.403728e+06</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.720737e+06</td>
      <td>Medicinal Chemicals and Botanical Products</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.233463e+06</td>
      <td>Accident &amp;Health Insurance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.889360e+05</td>
      <td>Advertising</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.821394e+06</td>
      <td>Aerospace</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.210042e+06</td>
      <td>Agricultural Chemicals</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3.422119e+06</td>
      <td>Air Freight/Delivery Services</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3.464666e+06</td>
      <td>Aluminum</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.276154e+06</td>
      <td>Apparel</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.671326e+06</td>
      <td>Assisted Living Services</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;../data/nasdaq_nyse_amex_with_sec_info.sqlite&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*), Industry FROM company_info GROUP BY Industry;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(*)</th>
      <th>Industry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>232</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62</td>
      <td>Medicinal Chemicals and Botanical Products</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>Accident &amp;Health Insurance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29</td>
      <td>Advertising</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25</td>
      <td>Aerospace</td>
    </tr>
    <tr>
      <th>5</th>
      <td>13</td>
      <td>Agricultural Chemicals</td>
    </tr>
    <tr>
      <th>6</th>
      <td>21</td>
      <td>Air Freight/Delivery Services</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>Aluminum</td>
    </tr>
    <tr>
      <th>8</th>
      <td>25</td>
      <td>Apparel</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>Assisted Living Services</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In order to automatically close connections after import or export, python offers the so-called <em>connection manager</em>. Usually, it is called with the keyword <code class="docutils literal notranslate"><span class="pre">with</span></code> and a variable after <code class="docutils literal notranslate"><span class="pre">as</span></code>. The connection is only active in the indented block afterwards and is closed when leaving this body of the context manager.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;../data/nasdaq_nyse_amex_with_sec_info.sqlite&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*), Industry FROM company_info GROUP BY Industry;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(*)</th>
      <th>Industry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>232</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62</td>
      <td>Medicinal Chemicals and Botanical Products</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>Accident &amp;Health Insurance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29</td>
      <td>Advertising</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25</td>
      <td>Aerospace</td>
    </tr>
    <tr>
      <th>5</th>
      <td>13</td>
      <td>Agricultural Chemicals</td>
    </tr>
    <tr>
      <th>6</th>
      <td>21</td>
      <td>Air Freight/Delivery Services</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>Aluminum</td>
    </tr>
    <tr>
      <th>8</th>
      <td>25</td>
      <td>Apparel</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>Assisted Living Services</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="04_getting_data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Collecting data</p>
      </div>
    </a>
    <a class="right-next"
       href="06_graphics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Graphics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframes-and-series">Pandas - DataFrames and Series</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing">Indexing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-methods">Useful Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plots">Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-and-exporting-data">Importing and Exporting Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#database-and-sql">Database and SQL</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#store-in-database">Store in Database</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Prof. Dr. Ralf Kellner
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>